<div class="container-fluid">

	<div class="row">
		<div class="col-md-12">
			 <h5 class="card-title text-primary"><strong>FY{{ cfy }} ON BOARDING JOURNEY</strong> for Merchandise New Customer (Priority 2.1)</h5>
		</div>
	</div>

	<div class="row">
		<div class="col-xl-6">

					 <div class="container">

            <div class="row">
                <div class="col-md-12">
                    <div class="main-timeline12">

                        <div class="col-md-2 col-sm-4 timeline">
													<span class="timeline-icon"><span class="timeline-icon">&#10024</span>
													</span>
													<div class="border"></div>
													<div class="timeline-content">
														<h4 class="title">Step1</h4>
														<p class="description">On Board whoever on this list</p>
													</div>
                        </div>

                        <div class="col-md-2 col-sm-4 timeline">
													<div class="timeline-content">
														<h4 class="title">Step2</h4>
														<p class="description">Cancel On Boarding when applicable</p>
													</div>
													<div class="border"></div>
													<span class="timeline-icon"><span class="timeline-icon">&#9940</span></span>
                        </div>

                        <div class="col-md-2 col-sm-4 timeline">
													<span class="timeline-icon"><span class="timeline-icon">&#10160</span></span>
													<div class="border"></div>
													<div class="timeline-content">
														<h4 class="title">Step3</h4>
														<p class="description">Check delivery Status for some</p>
													</div>
                        </div>

                        <div class="col-md-2 col-sm-4 timeline">
													<div class="timeline-content">
														<h4 class="title">Step4</h4>
														<p class="description">Change On Board Order if necessary</p>
													</div>
													<div class="border"></div>
													<span class="timeline-icon"><span class="timeline-icon">&#9972</span></span>
                        </div>

                        <div class="col-md-2 col-sm-4 timeline">
													<span class="timeline-icon"><span class="timeline-icon">&#9742</span></span>
													<div class="border"></div>
													<div class="timeline-content">
														<h4 class="title">Step5</h4>
														<p class="description">Thank You Call</p>
													</div>
                        </div>

												<div class="col-md-2 col-sm-4 timeline">
													<div class="timeline-content">
														<h4 class="title">Step6</h4>
														<p class="description">Bulk sending welcome pack</p>
													</div>
													<div class="border"></div>
													<span class="timeline-icon">&#9993</span>
												</div>

                    </div>
                </div>
            </div>
        </div>




		</div>

		<div class="col-md-6 col-xl-3">
			<div class="card border-primary mb-3 shadow-type7">
				<h5 class="card-header">Listing <strong>{{ '{:,}'.format(data.rows|length) }}</strong> customers found</h5>
				<div class="card-body">
					<h6 class="card-title"><span class="text-info">Searching Time Frame</span></h6>
					<p>{{ dates[0]|dAU }} &#8621 {{ dates[1]|dAU }}</p>
					<h6 class="card-title"><span class="text-info">Searching Criteria 1</span></h6>
					<p class="card-text">Contact that financially engaged with us for the first time within the &#8273Searching Time Frame&#8273
					</p>
					<h6 class="card-title"><span class="text-info">Searching Criteria 2</span></h6>
					<p class="card-text">More than zero of the total contribution was through merchandise platform on their first date of financial engagement
					</p>
				</div>
			</div>
		</div>

		<div class="col-md-6 col-xl-3">
			<div class="card border-info mb-3 shadow-type4">
				<div class="card-body">
					<h5 class="card-title">Tag Legends</h5>
					<span class="badge badge-pill badge-success">PM: Pure Merch Customer</span>
					<span class="badge badge-pill badge-dark">ORG: Organization</span>
					<span class="badge badge-pill badge-danger">ESTATE</span>
					<span class="badge badge-pill badge-danger">DECD: Deceased</span>
					<span class="badge badge-pill badge-warning">!MAIL: Do not mail</span>
					<span class="badge badge-pill badge-warning">!CALL: DO not call</span>
					<span class="badge badge-pill badge-info">HOUSEHOLD ROLE</span>
					<span class="badge badge-pill badge-dark">PMP: Pure Merch Pledger</span>
					<span class="badge badge-pill badge-dark">PMD: Pure Merch Donor</span>
				</div>
			</div>
		</div>
	</div>
	<hr>

	{% set table_name = 'merchandise-new-customer'  %}
     <div class="table-responsive-lg">
          <table class="table table-hover table-sm" id="{{ table_name }}">
               <caption><strong>Data Captured : </strong>{{ data.timestamp|dtAU }}, result will be cached for {{ '{:,}'.format(data.cached_timeout) }} seconds</caption>
               <thead>
                    <tr class="table-bordered table-dark">
                         <th scope="col">THANKQID</th>
                         <th scope="col">FIRST DATE</th>
                         <th scope="col">FIRST ORDER</th>
                         <th scope="col">FIRST DATE TOTAL MERCH</th>
                         <th scope="col">STATUS</th>
                         <th scope="col">ONBOARD</th>
                         <th scope="col">DELIVERED</th>
                         <th scope="col">THANK YOU</th>
                         <th scope="col">WELCOME PACK</th>
                    </tr>
               </thead>
               <tbody>
                    {% for row in data.rows %}
                    <tr {% if not row[2] %}class=""{% endif %}>
                         <th scope="row">{{ row.SERIALNUMBER }}</th>
                         <td>{{ row.FIRSTDATE|dAU }}</td>
                         <td><!--First Order ID-->
                              {% if row.FIRSTORDER %}
                                   {% if row.FIRSTORDERS|int > 1 %}
                                   <span class="text-primary" data-toggle="tooltip" data-html="true" data-placement="right" tabindex="0"
                                                  title='
                                                  Order ID was retrieved from <span class="text-warning">{{ row.FIRST_ORDER_SOURCE }}</span><hr />
                                                  Plus other <span class="text-success"><strong>{{ (row.FIRSTORDERS|int) - 1 }}</strong></span> more orders
                                                                 '
                                   >
                                        <strong>{{ row.FIRSTORDER }}</strong>
                                   </span>
                                   {% else %}
                                   <span class="text-primary" data-toggle="tooltip" data-html="true" data-placement="right" tabindex="0"
                                                  title='
                                                  Order ID was retrieved from <span class="text-warning">{{ row.FIRST_ORDER_SOURCE }}</span>'
                                   >
                                        {{ row.FIRSTORDER }}
                                   </span>
                                   {% endif %}
                              {% endif %}
                         </td>
                         <td><!--MERCHANDISE TOTAL-->
                              {% if row.FIRSTDATETOTAL == row.MERCHANDISE_TOTAL %}
                              <span class="text-info" data-toggle="tooltip" data-html="true" data-placement="right" tabindex="0"
                                                            title='
                                                            Pure Merchandise Customer<hr>
                                                            Purchase : {{ row.MERCHANDISE_PURCHASE|currency }}<br>
                                                            Pledge : {{ row.MERCHANDISE_PLEDGE|currency }}<br>
                                                            Donation+GOL : {{ (row.MERCHANDISE_TOTAL - row.MERCHANDISE_PURCHASE - row.MERCHANDISE_PLEDGE)|currency }}<br>
                                                            '
                              >
                              <strong>{{ row.MERCHANDISE_TOTAL|currency }}</strong>
                              </span>
                              {% else %}
                                   <span data-toggle="tooltip" data-html="true" data-placement="right" tabindex="0"
                                                  title='
                                                            Non Merchandise Total {{ (row.FIRSTDATETOTAL - row.MERCHANDISE_TOTAL)|currency }}
                                                            '
                                        >
                                        {{ row.MERCHANDISE_TOTAL|currency }}
                                   </span>
                              {% endif %}
                         </td>
                         <td><!--STATUS-->
                                   {% if row.FIRSTDATETOTAL == row.MERCHANDISE_TOTAL %}<span class="badge badge-pill badge-success">PM</span>{% endif %}
                                   {% if row.CONTACTTYPE|trim|upper == 'ORGANISATION' %}<span class="badge badge-pill badge-dark">ORG</span>{% endif %}
                                   {% if row.PRIMARYCATEGORY|trim|upper == 'ESTATE' %}<span class="badge badge-pill badge-danger">ESTATE</span>{% endif %}
                                   {% if row.DONOTMAILREASON|trim|upper == 'DECEASED' %}<span class="badge badge-pill badge-danger">DECD</span>{% endif %}
                                   {% if row.DONOTMAIL|int == -1 %}
                                        <span class="badge badge-pill badge-warning" data-toggle="tooltip" data-html="true" data-placement="top" tabindex="0"
                                                       title="{{ row.DONOTMAILREASON }}">
                                             !MAIL
                                        </span>
                                   {% endif %}
                                   {% if row.DONOTCALL|int == -1 %}<span class="badge badge-pill badge-warning">!CALL</span>{% endif %}
                                   {% if row.SORTKEYREF1 %}
                                        <span class="badge badge-pill badge-info" data-toggle="tooltip" data-html="true" data-placement="right" tabindex="0"
                                                       title="{{ row.SORTKEYREFREL1 }} : {{ row.SORTKEYREF1 }}">
                                             {{ row.SORTKEYREFREL2 }}
                                        </span>
                                   {% endif %}
                                   {% if row.MERCHANDISE_TOTAL==row.MERCHANDISE_PLEDGE %}<span class="badge badge-pill badge-dark">PMP</span>{% endif %}
                                   {% if row.MERCHANDISE_PURCHASE==0 %}<span class="badge badge-pill badge-dark">PMD</span>{% endif %}
                         </td>
                         <td><!--ON BOARDING STATUS-->
                              {% if row.PARAMETERNAME %}
                                   {% if row.EFFECTIVEFROM != row.EFFECTIVETO %}
                                        {% if row.PARAMETERVALUE == row.FIRSTORDER and row.EFFECTIVEFROM == row.FIRSTDATE  %}
                                             <span class="text-success" data-toggle="tooltip" data-html="true" data-placement="right" tabindex="0"
                                                            title='{{ row.PARAMETERNOTE or '' }}'>
                                                  <span class="badge badge-success">Boarded &#10084;</span>
                                             </span>
                                        {% else %}
                                             <span class="text-warning" data-toggle="tooltip" data-html="true" data-placement="right" tabindex="0"
                                                            title='{{ row.PARAMETERNOTE }}'>
                                                  <span class="badge badge-info">Boarded {{ row.PARAMETERVALUE }} (from {{ row.EFFECTIVEFROM|dAU }})</span>
                                             </span>
                                        {% endif %}
                                   {% else %}
                                        <span class="text-secondary" data-toggle="tooltip" data-html="true" data-placement="right" tabindex="0"
                                                       title='{{ row.PARAMETERNOTE }}'>
                                             <span class="badge badge-secondary">Cancelled &#9785;</span>
                                        </span>
                                   {% endif %}
                              {% else %}
                                   <span class="text-danger">Please On Board this contact</span>
                              {% endif %}
                         </td>
                         <td><!--AUS POST-->
                              {% if row.MERCHANDISE_TOTAL==row.MERCHANDISE_PLEDGE %}<span class="text-muted"><s>[Skipped]</s></span>
                              {% elif row.MERCHANDISE_PURCHASE==0 %}<span class="text-muted"><s>[Skipped]</s></span>
                              {% elif row.CONTACTTYPE|trim|upper == 'ORGANISATION' %}<span class="text-muted"><s>[Skipped]</s></span>
                              {% elif row.PRIMARYCATEGORY|trim|upper == 'ESTATE' %}<span class="text-muted"><s>[Skipped]</s></span>
                              {% elif row.DONOTMAILREASON|trim|upper == 'DECEASED' %}<span class="text-muted"><s>[Skipped]</s></span>
                              {% else %}
                                   <span class="text-warning">Waiting AUS Pos API</span>
                              {% endif %}
                         </td>
                         {% if row.PARAMETERNAME and row.EFFECTIVEFROM != row.EFFECTIVETO %}
                         {% set valid_profile = true  %}
                         {% else %}
                              {% set valid_profile = false  %}
                         {% endif %}
                         <td><!--ACTION1-->
                              {% if valid_profile %}
                              {% set thankyou_due = row.EFFECTIVEFROM|addworkingdays(7) %}
                                   X
                                   / <span class="text-{% if thankyou_due.date() > now.date() %}info{% elif thankyou_due.date()==now.date() %}warning{% else %}danger{% endif %}">{{ thankyou_due|dAU }}</span>
                              {% else %}
                                   <span class="text-muted">
                                        <s>No Valid Boarding Profile</s></span>
                              {% endif %}
                         </td>
                         <td><!--ACTION2-->
                              {% if valid_profile %}
                                   X
                                   / <span class="text-info">Check PickingSlip</span>
                              {% else %}
                                   <span class="text-muted">
                                        <s>No Valid Boarding Profile</s></span>
                              {% endif %}
                         </td>
                    </tr>
                    {% endfor %}
               </tbody>
          </table>
     </div>
</div>

<script>
let tblSelector = '#' + '{{ table_name }}';
</script>